<!DOCTYPE html>
<!-- saved from url=(0068)file:///Users/enkhmunkh/Documents/testProjects/HexagonBFS/index.html -->
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      body {
        margin: 0;
      }
      polygon {
        transition: all ease-in-out;
      }
      .active {
        animation: trans 0.1s;
        transition: all 0.1s;
      }
      @keyframes trans {
        0% {
          fill: rgba(255, 255, 255);
        }
        50% {
          fill: rgba(0, 0, 255);
        }
        100% {
          fill: rgba(255, 255, 255);
        }
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script>
      // const randomColor = () =>
      //   `rgb(${Math.round(Math.random() * 255)},${Math.round(
      //     Math.random() * 255
      //   )},${Math.round(Math.random() * 255)})`;
      const init = () => {
        const svg = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "svg"
        );
        svg.setAttribute("xmlns", "http://www.w3.org/2000/svg");
        svg.setAttribute("xmlns:xlink", "http://www.w3.org/1999/xlink");
        const container = document.getElementById("container");
        svg.setAttribute("width", window.innerWidth);
        svg.setAttribute("height", window.innerHeight);
        svg.setAttribute(
          "viewbox",
          `0 0 ${window.innerWidth} ${window.innerHeight}`
        );
        container.appendChild(svg);

        const radius = 12;
        const hexWidth = radius * Math.sqrt(3),
          hexHeight = radius * 2;
        const reduceY = radius / 2,
          reduceX = hexWidth / 2;
        let n = Math.ceil(window.innerHeight / (hexHeight - reduceY)),
          m = Math.ceil(window.innerWidth / hexWidth);
        // console.log(n * m);
        // return;

        const defaultPositions = [
          [hexWidth / 2, 0],
          [hexWidth, reduceY],
          [hexWidth, hexHeight - reduceY],
          [hexWidth / 2, hexHeight],
          [0, hexHeight - reduceY],
          [0, reduceY],
        ];
        let X = -hexWidth / 2,
          Y = -reduceY;

        for (let i = 0; i < n; i++) {
          for (let j = 0; j < m; j++) {
            hexagon(
              hexWidth * j + (i % 2 !== 0 ? reduceX : 0) + X,
              hexHeight * i + Y,
              i,
              j
            );
          }
          Y -= reduceY;
        }

        function hexagon(transX, transY, i, j) {
          var polygon = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "polygon"
          );
          const points = defaultPositions
            .map(([x, y]) => [`${x + transX} ${y + transY}`])
            .join(", ");
          polygon.setAttributeNS(null, "points", points);
          polygon.setAttributeNS(null, "fill", "rgb(255, 255, 255)");
          // polygon.setAttributeNS(null, "stroke-width", ".5");
          // polygon.setAttributeNS(null, "stroke", "cyan");
          polygon.id = `${i}-${j}`;
          polygon.onclick = () => {
            startWave(i, j);
          };
          svg.appendChild(polygon);
        }
        const startWave = (I, J) => {
          let arr = new Array(n).fill(null).map(() => new Array(m).fill(false));
          const movesOdd = [
            [-1, 0],
            [-1, 1],
            [0, 1],
            [1, 1],
            [1, 0],
            [0, -1],
          ];
          const movesEven = [
            [-1, -1],
            [-1, 0],
            [0, 1],
            [1, 0],
            [1, -1],
            [0, -1],
          ];
          let queue = [];
          queue.push([I, J, 0]);
          arr[I][J] = true;
          let delay = 0;
          setInterval(() => {
            let newQueue = [];
            while (queue.length > 0) {
              const [i, j, depth] = queue.shift();

              for (const [moveX, moveY] of i % 2 == 0 ? movesEven : movesOdd) {
                const newI = moveX + i,
                  newJ = moveY + j;
                if (
                  newI >= 0 &&
                  newI < n &&
                  newJ >= 0 &&
                  newJ < m &&
                  arr[newI][newJ] === false
                ) {
                  newQueue.push([newI, newJ, depth + 1]);
                  arr[newI][newJ] = true;
                  const polygon = document.getElementById(`${i}-${j}`);
                  polygon.setAttributeNS(null, "class", `active`);
                  setTimeout(() => {
                    polygon.removeAttributeNS(null, "class");
                  }, [100]);
                }
              }
            }
            queue = newQueue;
          }, 50);
        };
        // setInterval(() => {
        //   // startWave(Math.round(n / 2), Math.round(m / 2));
        //   startWave(0, 0);
        //   startWave(0, m - 1);
        //   startWave(n - 1, m - 1);
        //   startWave(n - 1, 0);
        // }, 2000);
      };
      window.onresize = () => {
        document.getElementById("container").innerHTML = "";
        init();
      };
      init();
    </script>
  </body>
</html>
